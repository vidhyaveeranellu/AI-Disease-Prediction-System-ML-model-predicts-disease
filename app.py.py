# -*- coding: utf-8 -*-
"""AI Disease Prediction System.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15f9hOfMvytDiu36zvq5guLR866u2NAS2
"""

from google.colab import files
files.upload()

import pandas as pd
import numpy as np

from sklearn.preprocessing import LabelEncoder
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

df = pd.read_csv("dataset.csv")
df.fillna("None", inplace=True)

print("Dataset loaded successfully")
print("Shape:", df.shape)

symptom_columns = df.columns[1:]  # exclude Disease column

all_symptoms = set()
for col in symptom_columns:
    all_symptoms.update(df[col].unique())

all_symptoms.discard("None")
all_symptoms = sorted(list(all_symptoms))

print("Total symptoms available:", len(all_symptoms))

X = df.drop("Disease", axis=1)
y = df["Disease"]

# One-hot encoding for symptoms (TEXT ‚Üí NUMERIC)
X_encoded = pd.get_dummies(X)

# Label encoding for disease
label_encoder = LabelEncoder()
y_encoded = label_encoder.fit_transform(y)

X_train, X_test, y_train, y_test = train_test_split(
    X_encoded, y_encoded, test_size=0.2, random_state=42
)

model = RandomForestClassifier(
    n_estimators=200,
    random_state=42
)

model.fit(X_train, y_train)

y_pred = model.predict(X_test)
print("Model Accuracy:", accuracy_score(y_test, y_pred))

print("\nüìã SELECT SYMPTOMS FROM THE LIST BELOW:\n")
for i, symptom in enumerate(all_symptoms, start=1):
    print(f"{i}. {symptom}")

selection = input(
    "\nEnter symptom numbers separated by comma (example: 2,7,15): "
)

selected_numbers = [int(i.strip()) for i in selection.split(",")]
user_symptoms = [all_symptoms[i-1] for i in selected_numbers]

print("\n‚úÖ You selected these symptoms:")
print(user_symptoms)

input_vector = np.zeros(len(X_encoded.columns))

for symptom in user_symptoms:
    matching_columns = [
        col for col in X_encoded.columns if col.endswith("_" + symptom)
    ]
    for col in matching_columns:
        input_vector[X_encoded.columns.get_loc(col)] = 1

input_df = pd.DataFrame([input_vector], columns=X_encoded.columns)

prediction = model.predict(input_df)
predicted_disease = label_encoder.inverse_transform(prediction)[0]

print("\nü©∫ Predicted Disease:", predicted_disease)

desc_df = pd.read_csv("symptom_Description.csv")
prec_df = pd.read_csv("symptom_precaution.csv")

description = desc_df[
    desc_df["Disease"] == predicted_disease
]["Description"].values[0]

precautions = prec_df[
    prec_df["Disease"] == predicted_disease
].values[0][1:]

print("\nüìò Disease Description:")
print(description)

print("\nüõ°Ô∏è Precautions:")
for i, p in enumerate(precautions, start=1):
    print(f"{i}. {p}")

from google.colab import drive
drive.mount('/content/drive')

